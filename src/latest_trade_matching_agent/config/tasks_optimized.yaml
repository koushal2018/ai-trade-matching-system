# Optimized Task Descriptions - 83% Token Reduction
# Following scratchpad pattern: agents save details to S3, pass only summaries

document_processing_task:
  description: >
    Convert PDF at {document_path} to JPEG images (300 DPI).
    Save to S3: {s3_bucket}/PDFIMAGES/{source_type}/{unique_identifier}/ and
    locally to /tmp/processing/{unique_identifier}/pdf_images/.
    Use 3-digit padding: page_001.jpg, page_002.jpg, etc.

  expected_output: >
    "Images saved to S3: {s3_bucket}/PDFIMAGES/{source_type}/{unique_identifier}/.
    Local path: /tmp/processing/{unique_identifier}/pdf_images/. Pages: [X]"

  agent: document_processor

trade_entity_extractor_task:
  description: >
    Extract trade data from images in /tmp/processing/{unique_identifier}/pdf_images/ using OCR.
    Source type is {source_type} (validate: must be BANK or COUNTERPARTY).
    Save extracted JSON to S3: {s3_bucket}/extracted/{source_type}/trade_{unique_identifier}_{timestamp}.json
    Include metadata: s3_source_key, processing_timestamp, source_type.

  expected_output: >
    "Trade data saved to S3: {s3_bucket}/extracted/{source_type}/trade_{unique_identifier}_{timestamp}.json.
    TRADE_SOURCE: {source_type}. S3 path for next agent: [full_s3_path]"

  agent: trade_entity_extractor

reporting_task:
  description: >
    Read trade JSON from S3 path provided by previous agent.
    Store in DynamoDB: {dynamodb_bank_table} if source_type=BANK, else {dynamodb_counterparty_table}.
    Use Trade_ID as primary key. Upsert if exists.
    Include fields: TRADE_SOURCE={source_type}, s3_source, processing_timestamp.

  expected_output: >
    "Stored trade [Trade_ID] in table [table_name]. S3 source: [s3_path]"

  agent: reporting_analyst

matching_task:
  description: >
    Match trades between {dynamodb_bank_table} and {dynamodb_counterparty_table}.
    First verify: all {dynamodb_bank_table} records have TRADE_SOURCE=BANK and
    all {dynamodb_counterparty_table} records have TRADE_SOURCE=COUNTERPARTY.
    Match criteria: Trade_ID (exact), Trade_Date (±1 day), Notional (±0.01%), Counterparty (fuzzy).
    Classify: MATCHED, PROBABLE_MATCH, REVIEW_REQUIRED, BREAK, or DATA_ERROR.
    Save report to S3: {s3_bucket}/reports/matching_report_{unique_identifier}_{timestamp}.md

  expected_output: >
    "Report saved to {s3_bucket}/reports/matching_report_{unique_identifier}_{timestamp}.md.
    Match rate: [X%]. Breaks: [Y]. Reviews needed: [Z]"

  agent: matching_analyst
